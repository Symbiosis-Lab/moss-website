---
topics:
  - Development Workflow
  - macOS
  - Tauri
---

# Dual Paths

## The Problem We Faced

Perfect integration requires compromise. Our right-click context menu worked beautifully - once installed. But during development, we couldn't test it without building and installing the app every time.

macOS only recognizes URL schemes like `moss://` for installed applications. Running with `cargo run` during development left our deep link integration non-functional. This created a development bottleneck: every code change required a full build-install-test cycle that killed iteration speed.

## What We Considered

**Option 1**: Build and install for every test (slow feedback)
**Option 2**: Mock the Finder integration (unrealistic testing)  
**Option 3**: Create an alternative entry point that works in development

## The Solution

We added a "Publish..." menu item to the system tray. Click it, pick a folder, same pipeline runs. The folder picker remembers your last selection - small convenience, big impact on development speed.

Now moss has two entry points:

- **Production**: Right-click folder → "Publish" (zero configuration)
- **Development**: Menu bar → "Publish..." (works immediately)

Both trigger identical processing. The difference is only in how you start.

## Key Discoveries

**Tauri resource bundling**: Resources live at `Contents/Resources/_up_/resources/` in production, not the expected `Contents/Resources/`. We detect both paths now.

**Context menu placement**: Removing `NSIconName` from Info.plist moves the service from "Quick Actions" submenu to main context menu. One property, one saved click.

**Dialog integration**: Tauri's dialog plugin is callback-based while our pipeline is async. A tokio channel bridges the gap cleanly.

## What This Means

Phase 0 is complete. moss can now:

- Transform any folder into a website
- Work for both developers and end users
- Install without configuration
- Remember preferences

## Trade-offs Made

**User Experience vs Developer Experience**: We chose to maintain both paths rather than compromising either. Right-click remains the primary interface, tray menu becomes the development interface.

**Code Complexity vs Workflow Simplicity**: Added a second entry point to preserve fast iteration during development. Both paths share identical processing logic.

**Memory vs Convenience**: File dialog remembers last folder selection, adding state management but significantly improving development ergonomics.

## Why This Matters

This establishes a design principle: **optimize for the common case while supporting edge cases**. Most users will right-click folders. Developers need the tray option during iteration.

The dual-path approach respects that different users have different constraints without forcing compromise on either side.

## Future Implications

Phase 0 completion opens Phase 1 development. The working foundation enables focus on themes, publishing, and social features without worrying about basic functionality.

This pattern - elegant primary interface plus developer-friendly alternative - will guide future feature design when user needs and developer needs diverge.

---

_Technical references:_

- _[Tauri Dialog Plugin](https://v2.tauri.app/plugin/dialog/) - Native file dialogs with async integration_
- _[Tauri Resource Bundling](https://v2.tauri.app/develop/resources/) - App resource path resolution and embedding files_
